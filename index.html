<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lightrunner</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
html,body{margin:0;padding:0;overflow:hidden;height:100%;background:black;font-family:'Share Tech Mono', monospace;}
canvas{display:block;}
#menu{
  position:absolute;top:0;left:0;width:100%;height:100%;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  background: rgba(0,0,0,0.85); z-index:10;color:white;
}
#menu input,#menu select,#menu button{
  margin:8px;padding:12px;font-size:18px;
  background:#111;border:2px solid cyan;color:white;border-radius:6px;
  text-shadow:0 0 5px cyan;
  cursor:pointer;transition:0.2s;
}
#menu input:focus,#menu select:focus,#menu button:hover{
  border-color:#0ff;text-shadow:0 0 10px #0ff;outline:none;
}
#title{
  font-size:72px;color:cyan;font-weight:bold;
  animation:bob 1.5s infinite alternate;
  margin-bottom:20px;
  text-shadow:0 0 15px cyan,0 0 30px cyan;
}
@keyframes bob{0%{transform:translateY(0px);}100%{transform:translateY(20px);}}
#hud{position:absolute;top:10px;left:10px;color:white;font-weight:bold;font-size:20px;z-index:5;}
</style>
</head>
<body>
<div id="menu">
  <div id="title">Lightrunner</div>
  <input id="playerName" placeholder="Enter your name" maxlength="12"/>
  <select id="bikeColor">
    <option value="cyan">Cyan</option>
    <option value="magenta">Magenta</option>
    <option value="yellow">Yellow</option>
    <option value="lime">Lime</option>
    <option value="blue">Blue</option>
    <option value="red">Red</option>
    <option value="green">Green</option>
  </select>
  <button id="startBtn">Run!</button>
  <div style="margin-top:10px;font-size:14px;opacity:0.8;">
    Controls: WASD to move, Space to throw disc
  </div>
</div>
<div id="hud"></div>
<canvas id="gameCanvas"></canvas>

<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
let width=canvas.width=window.innerWidth;
let height=canvas.height=window.innerHeight;
const hud=document.getElementById('hud');

let gameRunning=false;
const PLAYER_SPEED=5, BOT_BASE_SPEED=3;
let distance=0,score=0;

let player,bots=[],discs=[],projectiles=[],obstacles=[],trails=[];
let round=1,roundTimer=0,nextRoundDelay=3000;

class Bike{
  constructor(x,y,color,name,isBot=false){
    this.x=x;this.y=y;this.color=color;this.name=name;this.isBot=isBot;
    this.alive=true;this.ammo=0;this.trail=[];
  }
  move(delta){
    if(!this.alive)return;
    // Player input
    if(!this.isBot){
      if(keys.w) this.y-=PLAYER_SPEED;
      if(keys.s) this.y+=PLAYER_SPEED;
      if(keys.a) this.x-=PLAYER_SPEED;
      if(keys.d) this.x+=PLAYER_SPEED;
    }else{
      // Bot AI: chase player aggressively
      if(player){
        let dx=player.x-this.x,dy=player.y-this.y;
        let speed=BOT_BASE_SPEED+distance/500;
        this.x+=Math.sign(dx)*Math.min(Math.abs(dx),speed*0.5);
        this.y+=Math.sign(dy)*Math.min(Math.abs(dy),speed);
      }
    }
    // Leave trail
    this.trail.push({x:this.x,y:this.y});
    if(this.trail.length>100) this.trail.shift();
    trails.push({x:this.x,y:this.y,color:this.color});
    if(trails.length>1000) trails.shift();
  }
  draw(){
    if(!this.alive)return;
    ctx.shadowBlur=12;ctx.shadowColor=this.color;
    ctx.fillStyle=this.color;
    // Tilt effect
    let tiltX=(this.x-width/2)/width*20;
    ctx.fillRect(this.x-15-tiltX,this.y-30,30,60);
    ctx.shadowBlur=0;
  }
}

class Disc{
  constructor(){this.x=Math.random()*width; this.y=player.y-Math.random()*600-200; this.radius=8;}
  draw(){ctx.shadowBlur=10;ctx.shadowColor='white';ctx.fillStyle='white';ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.fill();ctx.shadowBlur=0;}
}

class Obstacle{
  constructor(){this.x=Math.random()*width; this.y=player.y-Math.random()*1000-300; this.w=50; this.h=50;}
  draw(){ctx.fillStyle='red';ctx.fillRect(this.x,this.y,this.w,this.h);}
}

class Projectile{
  constructor(x,y,color){this.x=x;this.y=y;this.color=color;this.alive=true;}
  update(){this.y-=10;if(this.y<player.y-1000)this.alive=false;}
  draw(){ctx.shadowBlur=12;ctx.shadowColor=this.color;ctx.fillStyle=this.color;ctx.beginPath();ctx.arc(this.x,this.y,6,0,Math.PI*2);ctx.fill();ctx.shadowBlur=0;}
}

function startGame(name,color){
  gameRunning=true;
  player=new Bike(width/2,height-100,color,name);
  bots=[];discs=[];projectiles=[];obstacles=[];trails=[];
  distance=0;score=0;round=1;roundTimer=0;
  for(let i=0;i<10;i++) discs.push(new Disc());
  for(let i=0;i<10;i++) obstacles.push(new Obstacle());
  loop();
}

function nextRound(){
  for(let i=0;i<round;i++){
    let color=bikeColors[Math.floor(Math.random()*bikeColors.length)];
    bots.push(new Bike(Math.random()*width,player.y-800,color,"Bot",true));
  }
  round++;
}

function update(delta){
  if(!player.alive)return;
  player.move(delta);
  bots.forEach(b=>b.move(delta));

  // Collect discs
  discs.forEach((d,i)=>{
    if(Math.abs(player.x-d.x)<20 && Math.abs(player.y-d.y)<20){
      player.ammo++;
      discs.splice(i,1); discs.push(new Disc());
    }
  });

  // Fire projectile
  if(keys.space && player.ammo>0){
    projectiles.push(new Projectile(player.x,player.y-40,player.color));
    player.ammo--;
    keys.space=false;
  }

  // Update projectiles
  projectiles.forEach((p,i)=>{
    p.update();
    if(!p.alive){projectiles.splice(i,1);return;}
    bots.forEach(b=>{
      if(b.alive && Math.abs(p.x-b.x)<20 && Math.abs(p.y-b.y)<40){
        b.alive=false;
        score+=50;
      }
    });
  });

  // Bots hitting player
  bots.forEach(b=>{
    if(b.alive && Math.abs(b.x-player.x)<20 && Math.abs(b.y-player.y)<40){
      player.alive=false;
    }
  });

  // Player hitting obstacles
  obstacles.forEach(o=>{
    if(player.x+15>o.x && player.x-15<o.x+o.w && player.y+30>o.y && player.y-30<o.y+o.h){
      player.alive=false;
    }
  });

  // Round system
  roundTimer+=delta;
  if(roundTimer>nextRoundDelay){roundTimer=0;nextRound();}

  // Increase score by distance
  distance+=PLAYER_SPEED;
  score=Math.floor(distance/10);
}

function draw(){
  ctx.clearRect(0,0,width,height);

  // Draw pseudo-3D floor
  ctx.fillStyle='rgba(0,255,255,0.05)';
  ctx.fillRect(0,0,width,height);

  // Draw trails
  trails.forEach(t=>{
    ctx.fillStyle=t.color;
    ctx.fillRect(t.x-2,t.y-2,4,4);
  });

  discs.forEach(d=>d.draw());
  obstacles.forEach(o=>o.draw());
  projectiles.forEach(p=>p.draw());
  if(player) player.draw();
  bots.forEach(b=>b.draw());

  hud.innerText=`Score: ${score} | Ammo: ${player?player.ammo:0}`;
}

function loop(timestamp){
  if(!gameRunning) return;
  requestAnimationFrame(loop);
  update(16);
  draw();
}

const keys={w:false,a:false,s:false,d:false,space:false};
document.addEventListener('keydown',e=>{
  if(e.key==='w')keys.w=true;
  if(e.key==='a')keys.a=true;
  if(e.key==='s')keys.s=true;
  if(e.key==='d')keys.d=true;
  if(e.key===' ')keys.space=true;
});
document.addEventListener('keyup',e=>{
  if(e.key==='w')keys.w=false;
  if(e.key==='a')keys.a=false;
  if(e.key==='s')keys.s=false;
  if(e.key==='d')keys.d=false;
});

const startBtn=document.getElementById('startBtn');
startBtn.addEventListener('click',()=>{
  const name=document.getElementById('playerName').value||'Runner';
  const color=document.getElementById('bikeColor').value||'cyan';
  document.getElementById('menu').style.display='none';
  startGame(name,color);
});

const bikeColors=["cyan","magenta","yellow","lime","blue","red","green"];
window.addEventListener('resize',()=>{width=canvas.width=window.innerWidth;height=canvas.height=window.innerHeight;});
</script>
</body>
</html>
